<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PokerSplit</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
  :root {
    --green: #1a6b3c;
    --green-light: #22c55e;
    --felt: #0f3d24;
    --gold: #f0c040;
    --bg: #0a1f12;
    --card: #112a1a;
    --border: #1e4d2b;
    --text: #e8f5ec;
    --muted: #6b9e7a;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    min-height: 100vh;
    padding: 0 0 60px;
    background-image:
      radial-gradient(ellipse at 20% 0%, #1a4d2a55 0%, transparent 60%),
      radial-gradient(ellipse at 80% 100%, #0d3b1e44 0%, transparent 60%);
  }

  header {
    padding: 32px 24px 20px;
    text-align: center;
    border-bottom: 1px solid var(--border);
    position: relative;
  }

  header::after {
    content: '';
    position: absolute;
    bottom: -1px; left: 50%;
    transform: translateX(-50%);
    width: 60px; height: 2px;
    background: var(--gold);
  }

  h1 {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 3rem;
    letter-spacing: 4px;
    color: var(--gold);
    line-height: 1;
  }

  .subtitle {
    color: var(--muted);
    font-size: 0.85rem;
    letter-spacing: 2px;
    text-transform: uppercase;
    margin-top: 4px;
  }

  .container { max-width: 520px; margin: 0 auto; padding: 0 16px; }

  /* SECTIONS */
  .section {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 20px;
    margin-top: 20px;
  }

  .section-title {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 1.2rem;
    letter-spacing: 2px;
    color: var(--gold);
    margin-bottom: 16px;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  /* CHIPS INPUT */
  .chip-row {
    display: grid;
    grid-template-columns: auto 1fr 120px;
    align-items: center;
    gap: 10px;
    padding: 10px 0;
    border-bottom: 1px solid #1a3d25;
  }
  .chip-row:last-child { border-bottom: none; }

  .chip-visual {
    width: 36px; height: 36px;
    border-radius: 50%;
    border: 3px solid;
    display: flex; align-items: center; justify-content: center;
    font-family: 'Bebas Neue', sans-serif;
    font-size: 0.7rem;
    flex-shrink: 0;
    position: relative;
    box-shadow: 0 2px 8px rgba(0,0,0,0.4);
  }

  .chip-visual::after {
    content: '';
    position: absolute;
    inset: 4px;
    border-radius: 50%;
    border: 1px dashed currentColor;
    opacity: 0.4;
  }

  .chip-label { font-size: 0.9rem; font-weight: 500; }
  .chip-sublabel { font-size: 0.75rem; color: var(--muted); }

  .chip-input-wrap { position: relative; }
  .chip-input-wrap input {
    width: 100%;
    background: #0a1f12;
    border: 1px solid var(--border);
    border-radius: 8px;
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    font-size: 1rem;
    font-weight: 600;
    padding: 8px 12px;
    text-align: center;
    transition: border-color 0.2s;
  }
  .chip-input-wrap input:focus { outline: none; border-color: var(--green-light); }
  .chip-input-wrap label {
    position: absolute;
    top: -8px; left: 8px;
    font-size: 0.65rem;
    color: var(--muted);
    background: #0a1f12;
    padding: 0 4px;
    letter-spacing: 1px;
    text-transform: uppercase;
  }

  /* ADD CHIP */
  .add-chip-row {
    display: grid;
    grid-template-columns: 1fr 1fr auto;
    gap: 8px;
    margin-top: 12px;
    padding-top: 12px;
    border-top: 1px dashed var(--border);
  }

  .add-chip-row input {
    background: #0a1f12;
    border: 1px solid var(--border);
    border-radius: 8px;
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    font-size: 0.9rem;
    padding: 8px 10px;
    width: 100%;
  }
  .add-chip-row input::placeholder { color: var(--muted); }
  .add-chip-row input:focus { outline: none; border-color: var(--green-light); }

  /* PLAYERS */
  .players-row {
    display: flex;
    align-items: center;
    gap: 16px;
  }

  .players-counter {
    display: flex;
    align-items: center;
    gap: 0;
    background: #0a1f12;
    border: 1px solid var(--border);
    border-radius: 12px;
    overflow: hidden;
  }

  .players-counter button {
    background: none;
    border: none;
    color: var(--green-light);
    font-size: 1.4rem;
    width: 44px; height: 44px;
    cursor: pointer;
    transition: background 0.15s;
    display: flex; align-items: center; justify-content: center;
  }
  .players-counter button:hover { background: #1a3d25; }

  .players-count {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 2rem;
    color: var(--gold);
    min-width: 50px;
    text-align: center;
    letter-spacing: 2px;
  }

  .players-label { color: var(--muted); font-size: 0.85rem; }

  /* BUY-IN */
  .buyin-input {
    display: flex;
    align-items: center;
    background: #0a1f12;
    border: 1px solid var(--border);
    border-radius: 8px;
    overflow: hidden;
    width: 180px;
  }
  .buyin-prefix {
    padding: 0 10px;
    color: var(--gold);
    font-weight: 600;
    font-size: 1rem;
    border-right: 1px solid var(--border);
    background: #0d2518;
    height: 44px;
    display: flex; align-items: center;
  }
  .buyin-input input {
    background: none;
    border: none;
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    font-size: 1rem;
    font-weight: 600;
    padding: 0 12px;
    width: 100%;
    height: 44px;
  }
  .buyin-input input:focus { outline: none; }

  /* BUTTONS */
  .btn-primary {
    width: 100%;
    background: linear-gradient(135deg, #1a6b3c, #22c55e);
    color: #fff;
    border: none;
    border-radius: 12px;
    font-family: 'Bebas Neue', sans-serif;
    font-size: 1.3rem;
    letter-spacing: 3px;
    padding: 16px;
    cursor: pointer;
    margin-top: 20px;
    transition: transform 0.15s, box-shadow 0.15s;
    box-shadow: 0 4px 20px #22c55e33;
  }
  .btn-primary:hover { transform: translateY(-1px); box-shadow: 0 6px 24px #22c55e55; }
  .btn-primary:active { transform: translateY(0); }

  .btn-sm {
    background: var(--green);
    color: var(--text);
    border: 1px solid var(--green-light);
    border-radius: 8px;
    font-family: 'DM Sans', sans-serif;
    font-size: 0.85rem;
    padding: 8px 14px;
    cursor: pointer;
    white-space: nowrap;
    transition: background 0.15s;
  }
  .btn-sm:hover { background: #1e5c34; }

  .btn-danger {
    background: none;
    border: none;
    color: #ef4444;
    cursor: pointer;
    font-size: 1.1rem;
    padding: 4px 8px;
    border-radius: 6px;
    transition: background 0.15s;
  }
  .btn-danger:hover { background: #3d1515; }

  /* RESULTS */
  #results { display: none; }

  .result-header {
    text-align: center;
    padding: 16px 0 8px;
  }

  .result-header .total-label {
    font-size: 0.75rem;
    color: var(--muted);
    letter-spacing: 2px;
    text-transform: uppercase;
  }

  .result-header .total-value {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 2.2rem;
    color: var(--gold);
    letter-spacing: 2px;
  }

  .player-card {
    background: #0a1f12;
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 16px;
    margin-top: 12px;
    position: relative;
    overflow: hidden;
  }

  .player-card::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 2px;
    background: linear-gradient(90deg, transparent, var(--green-light), transparent);
  }

  .player-name {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 1.1rem;
    letter-spacing: 2px;
    color: var(--gold);
    margin-bottom: 12px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .player-stack {
    font-size: 0.8rem;
    color: var(--green-light);
    font-weight: 600;
  }

  .chips-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
  }

  .chip-badge {
    display: flex;
    align-items: center;
    gap: 6px;
    background: #0f2d1b;
    border: 1px solid var(--border);
    border-radius: 20px;
    padding: 4px 10px 4px 6px;
    font-size: 0.82rem;
  }

  .chip-dot {
    width: 22px; height: 22px;
    border-radius: 50%;
    border: 2px solid;
    flex-shrink: 0;
    display: flex; align-items: center; justify-content: center;
    font-size: 0.55rem;
    font-family: 'Bebas Neue', sans-serif;
  }

  .chip-count { font-weight: 600; }
  .chip-val { color: var(--muted); font-size: 0.75rem; }

  .warning {
    background: #3d2a0a;
    border: 1px solid #a07020;
    border-radius: 10px;
    padding: 12px 16px;
    font-size: 0.85rem;
    color: #f0c040;
    margin-top: 12px;
  }

  .divider {
    text-align: center;
    color: var(--muted);
    font-size: 0.75rem;
    letter-spacing: 2px;
    margin: 8px 0 0;
  }

  /* COLOR PICKER for add chip */
  .color-options {
    display: flex;
    gap: 6px;
    flex-wrap: wrap;
    margin-top: 8px;
  }
  .color-opt {
    width: 24px; height: 24px;
    border-radius: 50%;
    border: 2px solid transparent;
    cursor: pointer;
    transition: transform 0.15s, border-color 0.15s;
  }
  .color-opt:hover, .color-opt.selected { transform: scale(1.2); border-color: white; }

  .form-row {
    display: flex;
    align-items: center;
    gap: 16px;
    flex-wrap: wrap;
  }

  @media (max-width: 400px) {
    h1 { font-size: 2.4rem; }
    .add-chip-row { grid-template-columns: 1fr 1fr; }
    .add-chip-row .btn-sm { grid-column: 1/-1; }
  }
</style>
</head>
<body>

<header>
  <h1>PokerSplit</h1>
  <p class="subtitle">Divisor de Fichas</p>
</header>

<div class="container">

  <!-- CHIPS SECTION -->
  <div class="section">
    <div class="section-title">üé∞ Fichas na Maleta</div>
    <div id="chips-list"></div>

    <div class="add-chip-row">
      <input type="number" id="new-value" placeholder="Valor (ex: 25)" min="1">
      <input type="number" id="new-qty" placeholder="Qtd (ex: 40)" min="1">
      <button class="btn-sm" onclick="addChip()">+ Adicionar</button>
    </div>

    <div style="margin-top:10px;">
      <div style="font-size:0.75rem; color:var(--muted); margin-bottom:6px; letter-spacing:1px; text-transform:uppercase;">Cor da ficha</div>
      <div class="color-options" id="color-options"></div>
    </div>
  </div>

  <!-- PLAYERS SECTION -->
  <div class="section">
    <div class="section-title">üë• Jogadores</div>
    <div class="players-row">
      <div class="players-counter">
        <button onclick="changeP(-1)">‚àí</button>
        <div class="players-count" id="p-count">4</div>
        <button onclick="changeP(1)">+</button>
      </div>
      <div class="players-label">jogadores na mesa</div>
    </div>
  </div>

  <!-- BUY-IN SECTION -->
  <div class="section">
    <div class="section-title">üí∞ Buy-in por Jogador</div>
    <div class="form-row">
      <div class="buyin-input">
        <span class="buyin-prefix">R$</span>
        <input type="number" id="buyin" value="10" min="0" placeholder="0">
      </div>
      <span style="color:var(--muted); font-size:0.85rem;">por jogador</span>
    </div>
  </div>

  <button class="btn-primary" onclick="calculate()">üÉè DISTRIBUIR FICHAS</button>

  <!-- RESULTS -->
  <div id="results">
    <div class="section">
      <div class="section-title">üìä Resultado</div>
      <div id="result-summary"></div>
      <div id="player-results"></div>
    </div>
  </div>

</div>

<script>
// ---- STATE ----
const COLORS = [
  { name: 'Branco',    bg: '#f0f0f0', border: '#c0c0c0', text: '#333' },
  { name: 'Vermelho',  bg: '#dc2626', border: '#991b1b', text: '#fff' },
  { name: 'Azul',      bg: '#2563eb', border: '#1d4ed8', text: '#fff' },
  { name: 'Verde',     bg: '#16a34a', border: '#166534', text: '#fff' },
  { name: 'Preto',     bg: '#1c1c1c', border: '#555',    text: '#fff' },
  { name: 'Amarelo',   bg: '#f59e0b', border: '#d97706', text: '#333' },
  { name: 'Rosa',      bg: '#ec4899', border: '#db2777', text: '#fff' },
  { name: 'Dourado',   bg: '#f0c040', border: '#b8960c', text: '#333' },
];

let chips = [
  { value: 1,    qty: 100, colorIdx: 0 }, // branco
  { value: 5,    qty: 50,  colorIdx: 1 }, // vermelho
  { value: 25,   qty: 25,  colorIdx: 3 }, // verde
  { value: 50,   qty: 50,  colorIdx: 2 }, // azul
  { value: 100,  qty: 25,  colorIdx: 4 }, // preto
  { value: 500,  qty: 0,   colorIdx: 6 }, // rosa
  { value: 1000, qty: 0,   colorIdx: 7 }, // dourado
];
let players = 4;
let selectedColor = 2;

// ---- INIT ----
function init() {
  renderColorOptions();
  renderChips();
}

function renderColorOptions() {
  const el = document.getElementById('color-options');
  el.innerHTML = COLORS.map((c, i) => `
    <div class="color-opt ${i === selectedColor ? 'selected' : ''}"
         style="background:${c.bg}; border-color:${i===selectedColor?'white':c.border}"
         onclick="selectColor(${i})"
         title="${c.name}"></div>
  `).join('');
}

function selectColor(i) {
  selectedColor = i;
  renderColorOptions();
}

function renderChips() {
  const el = document.getElementById('chips-list');
  if (chips.length === 0) {
    el.innerHTML = '<div style="color:var(--muted);text-align:center;padding:16px;font-size:0.9rem;">Nenhuma ficha adicionada</div>';
    return;
  }
  el.innerHTML = chips.map((c, i) => {
    const col = COLORS[c.colorIdx];
    return `
    <div class="chip-row">
      <div class="chip-visual" style="background:${col.bg};border-color:${col.border};color:${col.text}">
        ${c.value >= 1000 ? (c.value/1000)+'K' : c.value}
      </div>
      <div>
        <div class="chip-label" style="color:${col.bg}">${col.name}</div>
        <div class="chip-sublabel">Valor: <b>R$ ${c.value}</b></div>
      </div>
      <div class="chip-input-wrap">
        <label>FICHAS</label>
        <input type="number" value="${c.qty}" min="0"
          oninput="chips[${i}].qty=parseInt(this.value)||0"
          style="border-color:${col.border}44">
      </div>
      <button class="btn-danger" onclick="removeChip(${i})">‚úï</button>
    </div>`;
  }).join('');
}

function addChip() {
  const val = parseInt(document.getElementById('new-value').value);
  const qty = parseInt(document.getElementById('new-qty').value);
  if (!val || val <= 0 || !qty || qty <= 0) {
    alert('Preencha valor e quantidade v√°lidos!');
    return;
  }
  chips.push({ value: val, qty, colorIdx: selectedColor });
  chips.sort((a,b) => a.value - b.value);
  document.getElementById('new-value').value = '';
  document.getElementById('new-qty').value = '';
  renderChips();
}

function removeChip(i) {
  chips.splice(i, 1);
  renderChips();
}

function changeP(delta) {
  players = Math.max(2, Math.min(20, players + delta));
  document.getElementById('p-count').textContent = players;
}

// ---- ALGORITHM ----
// For each denomination, each player gets exactly floor(qty / players).
// The remainder (qty % players) stays in the suitcase ‚Äî NO player gets more than another.
// This guarantees every player has the EXACT same number of each chip type.

function calculate() {
  if (chips.length === 0) { alert('Adicione fichas primeiro!'); return; }

  const buyin = parseFloat(document.getElementById('buyin').value) || 0;

  // Only consider chips with qty > 0
  const activeChips = chips.filter(c => c.qty > 0);
  if (activeChips.length === 0) { alert('Todas as fichas est√£o zeradas!'); return; }

  // For each denomination: perPlayer = floor(qty / players), leftover stays in suitcase
  const distribution = activeChips.map(c => ({
    ...c,
    perPlayer: Math.floor(c.qty / players),
    leftover:  c.qty % players,
  }));

  // Stack value per player (same for every player ‚Äî guaranteed equal)
  const stackValue = distribution.reduce((s, d) => s + d.value * d.perPlayer, 0);
  const totalChipsPerPlayer = distribution.reduce((s, d) => s + d.perPlayer, 0);

  // Leftover chips (stay in suitcase)
  const leftovers = distribution.filter(d => d.leftover > 0);
  const totalLeftoverValue = leftovers.reduce((s, d) => s + d.value * d.leftover, 0);
  const totalDistributedValue = stackValue * players;

  // Build summary
  let summaryHtml = `
    <div class="result-header">
      <div class="total-label">Stack por Jogador</div>
      <div class="total-value">R$ ${stackValue.toLocaleString('pt-BR')}</div>
      <div class="divider">${totalChipsPerPlayer} fichas por jogador ¬∑ ${players} jogadores</div>
    </div>`;

  if (buyin > 0 && stackValue > 0) {
    const chipPerReal = stackValue / buyin;
    summaryHtml += `
      <div style="background:#0a2518;border:1px solid var(--border);border-radius:10px;padding:12px 16px;margin-top:12px;font-size:0.87rem;">
        üí∞ Buy-in <b style="color:var(--gold)">R$ ${buyin}</b> ‚Üí stack de <b style="color:var(--green-light)">R$ ${stackValue}</b> em fichas
        <br><span style="color:var(--muted)">1 real = ${chipPerReal.toFixed(1)}√ó o valor em fichas</span>
      </div>`;
  }

  if (leftovers.length > 0) {
    const leftoverLines = leftovers.map(d => {
      const col = COLORS[d.colorIdx];
      return `<span style="color:${col.bg}">${d.leftover}√ó R$${d.value}</span>`;
    }).join(', ');
    summaryHtml += `
      <div class="warning">
        üéí Fichas que ficam na maleta (n√£o divis√≠veis igualmente):<br>
        <span style="font-size:0.9rem">${leftoverLines}</span>
        <br><span style="color:#c89a30;font-size:0.8rem">Valor total guardado: R$ ${totalLeftoverValue}</span>
      </div>`;
  } else {
    summaryHtml += `<div style="background:#0a2a15;border:1px solid #22c55e44;border-radius:10px;padding:10px 16px;margin-top:12px;font-size:0.85rem;color:#22c55e;">‚úÖ Divis√£o perfeita ‚Äî nenhuma ficha sobrou!</div>`;
  }

  // Player cards (all identical, so we show one template + note)
  let playersHtml = '';
  for (let p = 0; p < players; p++) {
    const chipsHtml = distribution
      .filter(d => d.perPlayer > 0)
      .sort((a,b) => b.value - a.value)
      .map(d => {
        const col = COLORS[d.colorIdx];
        return `
          <div class="chip-badge">
            <div class="chip-dot" style="background:${col.bg};border-color:${col.border};color:${col.text}">
              ${d.value >= 1000 ? (d.value/1000)+'K' : d.value}
            </div>
            <span class="chip-count">${d.perPlayer}√ó</span>
            <span class="chip-val">R$${d.value}</span>
          </div>`;
      }).join('');

    playersHtml += `
      <div class="player-card">
        <div class="player-name">
          JOGADOR ${p+1}
          <span class="player-stack">R$ ${stackValue}</span>
        </div>
        <div class="chips-grid">${chipsHtml}</div>
      </div>`;
  }

  document.getElementById('result-summary').innerHTML = summaryHtml;
  document.getElementById('player-results').innerHTML = playersHtml;

  const resultsEl = document.getElementById('results');
  resultsEl.style.display = 'block';
  setTimeout(() => resultsEl.scrollIntoView({ behavior: 'smooth', block: 'start' }), 100);
}

init();
</script>
</body>
</html>
